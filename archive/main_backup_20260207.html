<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ÏïÑÏßÑÏù¥ Í≤åÏûÑ - Î©îÏù∏</title>

  <style>
    html, body {
      height:100%; margin:0; background:#f6f6f6;
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", sans-serif;
      display:flex; justify-content:center; align-items:center;
    }
    #gameWrap{
      aspect-ratio:3/4;
      height:100vh; max-height:100vh; width:auto;
      background:#fff; border:1px solid #ddd;
      position:relative; overflow:hidden;
    }
    canvas{ width:100%; height:100%; display:block; }

    button{
      padding:12px 18px;
      border-radius:12px;
      border:1px solid #cfcfcf;
      background:#fff;
      font-weight:800;
      cursor:pointer;
      z-index:30;
      position:absolute;
    }
    #backBtn{ top:16px; left:16px; }
    #broadcastBtn{
      right:16px; top:50%;
      transform:translateY(-50%);
      background:#ffe066; border-color:#f2c94c;
    }

    /* Î©îÏù∏ UI */
    #mainUI { position:absolute; inset:0; z-index:20; pointer-events:none; }
    #mainUI .clickable { pointer-events:auto; }

    #leftPanel{
      position:absolute; left:18px; top:70px;
      width:42%; height:34%;
      border:2px solid #111; border-radius:22px; background:#fff;
      padding:14px; box-sizing:border-box;
    }
    .row{ display:flex; gap:10px; align-items:center; margin-bottom:10px; }
    .big{
      flex:1; height:44px;
      border:2px solid #111; border-radius:14px;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; background:#fff;
    }
    .small{
      width:56px; height:44px;
      border:2px solid #111; border-radius:14px;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; background:#fff;
    }
    .mid{
      width:100%; height:44px;
      border:2px solid #111; border-radius:14px;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; background:#fff;
      margin-bottom:10px;
    }
    .grid2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }

    .tile{
      height:52px;
      border:2px solid #111; border-radius:14px;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; background:#fff;
    }

    #topRight{
      position:absolute; right:18px; top:18px;
      width:40%;
      display:flex; flex-direction:column; gap:12px;
      align-items:flex-end;
      pointer-events:auto;
    }
    #coins{
      width:72%; height:44px;
      border:2px solid #111; border-radius:14px;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 12px; box-sizing:border-box;
      font-weight:900; background:#fff;
    }
    #swatches{ display:flex; gap:14px; align-items:center; }
    .swatchWrap{ text-align:center; font-size:12px; font-weight:800; }
    .swatch{
      width:44px; height:44px;
      border:2px solid #111; border-radius:14px;
      background:#fff; margin:0 auto 6px auto;
      box-sizing:border-box;
    }

    #leftIcons{
      position:absolute; left:18px; top:54%;
      transform:translateY(-50%);
      display:flex; flex-direction:column; gap:14px;
      pointer-events:auto;
    }
    .circleIcon{
      width:54px; height:54px;
      border:2px solid #111; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-weight:1000; background:#fff;
      user-select:none;
    }

    #bottomBar{
      position:absolute; left:50%; bottom:22px;
      transform:translateX(-50%);
      width:86%; height:72px;
      border:2px solid #111; border-radius:40px;
      display:flex; align-items:center; justify-content:space-around;
      background:#fff; box-sizing:border-box; padding:0 14px;
      pointer-events:auto;
    }
    .navItem{
      width:58px; height:58px;
      border:2px solid #111; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-weight:1000; background:#fff; user-select:none;
    }
  </style>
</head>

<body>
  <div id="gameWrap">
    <button id="backBtn">Îí§Î°ú</button>
    <button id="broadcastBtn">Î∞©ÏÜ°</button>

    <div id="mainUI">
      <div id="leftPanel" class="clickable">
        <div class="row">
          <div class="big clickable" data-act="ÌôàÌååÌã∞">ÌôàÌååÌã∞</div>
          <div class="small clickable" data-act="ÏπúÍµ¨">ÏπúÍµ¨</div>
        </div>

        <div class="mid clickable" data-act="ÌÜ†ÎÅºTV">ÌÜ†ÎÅºTV</div>
        <div class="mid clickable" data-act="Ï†ÑÍµ≠" style="height:34px; font-size:13px;">Ï†ÑÍµ≠</div>

        <div class="grid2">
          <div class="tile clickable" data-act="Ïù¥Í≥≥">Ïù¥Í≥≥</div>
          <div class="tile clickable" data-act="Í≤åÏûÑ">Í≤åÏûÑ</div>
        </div>
        <!-- ‚úÖ ÏÑ§Ï†ï/Ï†ÑÌôîÍ∏∞/ÎåÄÏû•Î≤å ÏÇ≠Ï†ú -->
      </div>

      <div id="topRight">
        <div id="coins" class="clickable" data-act="ÏΩîÏù∏">
          <span style="font-weight:1000;">b</span>
          <span style="letter-spacing:2px;">0000</span>
        </div>
        <div id="swatches">
          <div class="swatchWrap clickable" data-act="Ïù¥Î≤§Ìä∏"><div class="swatch"></div>Ïù¥Î≤§Ìä∏</div>
          <div class="swatchWrap clickable" data-act="ÏßÄÎèÑ"><div class="swatch"></div>ÏßÄÎèÑ</div>
          <div class="swatchWrap clickable" data-act="Ï£ºÍ∏∞"><div class="swatch"></div>Ï£ºÍ∏∞</div>
        </div>
      </div>

      <div id="leftIcons">
        <div class="circleIcon clickable" data-act="Ìôà">‚åÇ</div>
        <div class="circleIcon clickable" data-act="ÌÜ°">ÌÜ°</div>
      </div>

      <div id="bottomBar" class="clickable">
        <div class="navItem clickable" data-act="ÏáºÌïë">ÏáºÌïë</div>
        <div class="navItem clickable" data-act="Ïª§Ìîå">Ïª§Ìîå</div>
        <div class="navItem clickable" data-act="Ï¥àÎ°ù">Ï¥àÎ°ù</div>
        <div class="navItem clickable" data-act="ÌÉÑÍ≤Ä">ÌÉÑÍ≤Ä</div>
      </div>

      <!-- ‚úÖ Î∞©ÏÜ° ÌÅ∞ Î≤ÑÌäº(ÎßêÌíçÏÑ†) ÏÇ≠Ï†ú -->
    </div>

    <canvas id="game"></canvas>
  </div>

  <script>
    const ASSETS = { girl: "girl.png", boy: "boy.png" };

    const params = new URLSearchParams(location.search);
    const gender = (params.get("gender") === "boy") ? "boy" : "girl";

    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    let images = {};

    function resize(){
      const rect = canvas.getBoundingClientRect();
      const dpr = window.devicePixelRatio || 1;
      canvas.width = Math.round(rect.width * dpr);
      canvas.height = Math.round(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      draw();
    }
    window.addEventListener("resize", resize);

    function loadImage(src){
      return new Promise((res, rej)=>{
        const img = new Image();
        img.onload = ()=>res(img);
        img.onerror = ()=>rej(new Error("Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®: " + src));
        img.src = src;
      });
    }

    function draw(){
      const w = canvas.clientWidth;
      const h = canvas.clientHeight;
      ctx.clearRect(0,0,w,h);

      const img = images[gender];
      if(!img) return;

      // ‚úÖ Ï∫êÎ¶≠ÌÑ∞ ÌÅ¨Í∏∞/ÏúÑÏπò: Ïù∏Ìä∏Î°úÏôÄ ÎèôÏùºÌïòÍ≤å Ïú†ÏßÄ
      const targetH = h * 0.62;
      const scale = targetH / img.height;
      const dw = img.width * scale;
      const dh = img.height * scale;

      const bottomReserved = 90; // ‚úÖ Ïù¥Îèô Ïïà Ìï®(Ïù∏Ìä∏Î°úÏôÄ ÎèôÏùº)
      const x = (w - dw) / 2;
      const y = h - dh - bottomReserved;

      ctx.drawImage(img, x, y, dw, dh);
    }

    document.getElementById("broadcastBtn").onclick = ()=> alert("üì° Î∞©ÏÜ° (Îã§Ïùå Îã®Í≥ÑÏóêÏÑú Ïó∞Í≤∞)");
    document.getElementById("backBtn").onclick = ()=> {
      location.href = `index.html?gender=${encodeURIComponent(gender)}`;
    };

    document.getElementById("mainUI").addEventListener("click", (e)=>{
      const el = e.target.closest("[data-act]");
      if(!el) return;
      alert("ÌÅ¥Î¶≠: " + el.dataset.act);
    });

    (async function init(){
      images.girl = await loadImage(ASSETS.girl);
      images.boy  = await loadImage(ASSETS.boy);
      resize();
    })().catch(err=>{
      console.error(err);
      alert(err.message);
    });
  </script>
</body>
</html>
